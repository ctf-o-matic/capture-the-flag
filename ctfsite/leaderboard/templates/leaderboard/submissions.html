{% extends "base.html" %}

{% block pagetitle %}Capture The Flag{% endblock %}

{% block keywords %}{% endblock %}

{% block description %}{% endblock %}

{% block content %}

<div class="jumbotron bg-transparent mb-0 radius-0">
  <div class="container">
      <div class="row">
        <div class="col-xl-12">
            {% if not level_name %}
                <div class="alert alert-success">Congratulations, you have captured the flag, well done!</div>
            {% else %}
              {% if just_passed_level %}
                <div class="alert alert-success" role="alert">
                  Correct submission, congrats on passing the level!
                </div>
              {% endif %}

              {% if team.next_level_index == 0 %}
                <h1>Submit a solution</h1>
                  <p class="text-grey">
                    You can begin the CTF challenge by running <code>ssh -p 8022 level0@34.66.129.228</code> from your shell.
                  </p>

                  <p class="text-grey">
                    Your goal is to read the contents of <code>/home/level1/.password</code>.
                    In <code>/levels/level1</code>, you'll find a binary owned by <code>level1</code> (as well as its source code)
                    â€” you will probably find it useful.
                    Once you have the password, you can <code>ssh</code> in as <code>level1</code>,
                    where new instructions await you.
                  </p>
              {% elif team.can_submit %}
                <h1>Submit a solution</h1>
                  <p class="text-grey">
                    Continue to the next level by running <code>ssh -p 8022 {{ team.next_level.name }}@34.66.129.228</code>
                      from your shell, and follow the instructions.
                  </p>
              {% endif %}

              <form method="post" action="{% url 'leaderboard:create-submission' %}" class="needs-validation" novalidate>
                  {% csrf_token %}
                  {% include 'leaderboard/form-errors.html' %}
                <div class="form-row align-items-center">
                  <div class="col-sm-4">
                    <input name="answer_attempt" type="text" class="form-control" placeholder="The password" required>
                    <div class="invalid-feedback">Please enter the password.</div>
                  </div>
                  <div class="col-auto">
                    <button class="btn btn-primary" type="submit">Submit</button>
                  </div>
                </div>
              </form>

              {% include 'leaderboard/form-frontend-validations.html' %}
            {% endif %}

            {% if submissions %}
                <h2 class="mb-3 mt-3">Submissions</h2>
                <div class="list-group col-xl-6">
                {% for submission in submissions %}
                  <div class="list-group-item">
                    <div class="d-flex justify-content-between">
                      <code>{{submission.level_name}}</code>
                      <small>{{submission.date}}</small>
                    </div>
                  </div>
                {% endfor %}
                </div>
            {% endif %}

        </div>
      </div>
  </div>
</div>

{% endblock %}
