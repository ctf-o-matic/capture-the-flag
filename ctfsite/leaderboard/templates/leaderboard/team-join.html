<h1>Join a team</h1>

<div class="alert alert-info">
    You are not in a team, yet. Only teams can submit solutions.
    {% if available_teams %}
        You can either join one of the available teams, or create a new team.
    {% else %}
        There are no available teams, yet. You can go ahead and create one.
    {% endif %}
</div>

{% if available_teams %}
    <h2 class="mb-3 mt-3">Available teams</h2>
    {% if join_error %}
        <div class="alert alert-warning">
            {% if join_error == "team-missing" %}
                Sorry, it seems the team you selected has disappeared...
            {% elif join_error == "team-full" %}
                Sorry, it seems the team you selected is no longer available (no more slots)...
            {% elif join_error == "team-has-submissions" %}
                Sorry, it seems the team you selected is no longer available (has already submissions)...
            {% else %}
                Unknown error: {{ join_error }}
            {% endif %}
            Please choose another team!
        </div>
    {% endif %}

    <table class="table ">
        <tbody>
        {% for team in available_teams %}
            <tr>
                <td class="align-middle">{{team}} (<span class="text-muted">
                    {% for tm in team.teammember_set.all %}
                        {{ tm.user }}{% if not forloop.last %},{% endif %}
                    {% endfor %}</span>
                    )
                </td>
                <td><a href="{% url 'leaderboard:join-team' team.pk %}" class="btn btn-secondary">Join this team</a></td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
{% elif join_error %}
    <h2 class="mb-3 mt-3">Available teams</h2>
    <div class="alert alert-warning">
        Sorry, it seems the team you selected is no longer available.
        In fact there are no more available teams.
        At the moment you have no choice but to create your own!
    </div>
{% endif %}

<h2>Create a new team</h2>

{% include 'leaderboard/form-errors.html' %}

<form method="post" action="{% url 'leaderboard:create-team' %}" class="needs-validation" novalidate>
    {% csrf_token %}
    <div class="form-row align-items-center">
        <div class="col-sm-4">
            <input name="team_name" type="text" class="form-control" placeholder="Team name to create, ex: Foo Fighters"
                   required>
            <div class="invalid-feedback">Please enter a name for the team.</div>
        </div>
        <div class="col-auto">
            <button class="btn btn-primary" type="submit">Create team</button>
        </div>
    </div>
</form>

{% include 'leaderboard/form-frontend-validations.html' %}
